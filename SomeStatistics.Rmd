---
title: "Some_statistics"
author: "Jeronimo Miranda"
date: "`r Sys.Date()`"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r source data, message=FALSE, warning=FALSE, include=FALSE}
library(ggExtra)
source("scriptlncrna.R")
```

## Length distribution of transcripts

The protein coding mRNAs come from the trinotate file, that makes a blast against the uniprot database both mRNA and protein to find orthologs. Protein coding are all of the mRNAs that had an ortholog in uniprot. These sequences were then aligned back to the transcriptome and filtered for alignments on the Antisense strand greater than 300 bp. The Target transcripts thus found are labelled as antisense transcripts. Out of the 39,844 unique transcripts with a swissprot annotation, we find only 9930 with at least one antisense transcript. On the other hand, the total number of unique antisense transcripts found this way is 26,953. 



The length distribution of the two differ, with the antisense transcripts being closer to the whole transcriptome numbers (i. e. skewing towards smaller). 

```{r summary, message=FALSE, warning=TRUE}
select(ampirr, total_length.qer, total_length.target) %>% transmute(Protein_coding_mRNAs = total_length.qer, Antisense_Transcripts = total_length.target) %>% summary()
```
We can see that through all quartiles, Protein coding mRNAs are longer than antisense Transcripts, with the median protein coding mRNA being 1kb while half of antisense transcripts are shorter than 413 nucleotides (this is after already filtering all non coding RNAs shorter than 200 bp). Compare to the total length distribution of the transcriptome: 75% of all transcripts have a length of less than 687 nucleotides:

```{r summary whole, echo=FALSE, message=FALSE, warning=FALSE}
summary(longitudes)
```



```{r Grafica de longitud, message=FALSE, warning=FALSE}
#pivot to longer dataframe
ampirr %>% transmute(qseqid, sseqid, Protein_coding_mRNAs = total_length.qer, Antisense_Transcripts = total_length.target) %>% 
  pivot_longer(cols = Protein_coding_mRNAs:Antisense_Transcripts, names_to = "mRNA_type", values_to = "mRNA_length") %>% 
  #This operation is to chose the transcript id from the two seqid columns
  transmute(transcript_id = if_else(mRNA_type == "Protein_coding_mRNAs", qseqid, sseqid), mRNA_type, mRNA_length) %>% unique() %>% 
  #now you can plot
  ggplot(aes(x = mRNA_length)) + geom_histogram(binwidth = 200) + scale_x_continuous(n.breaks = 10) + xlim(c(0,16500)) + theme_bw() + facet_wrap(~mRNA_type, nrow = 2, scales = "free_y") + labs(x = "mRNA length [nucleotides]", title = "Antisense transcripts are generally shorter than their targets, but more numerous", subtitle = "Histogram distribution of transcript length")

```



